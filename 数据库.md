## 数据库系统原理

### 1.基础知识

#### 相关概念

**四个基本概念**

- **数据（Data）**：数据描述事物的符号记录；常见的种类有：文本，图形，图像，音频，视频等；特点是：数据与其语义是不可分的。
- **数据库（Database）**：是长期存储在计算机内、有组织的、可共享的大量数据的集合。基本特征：可共享，冗余度较小，数据独立性较高，易扩展，数据按照一定的模型组织、描述和存储。
- **数据库管理系统（DBMS）**：位于用户和操作系统之间的一层数据管理软件。主要功能：数据定义功能，数据组织、存储和管理，数据操纵功能，数据库的事物管理和运行管理，数据库的建立和维护功能。
- **数据库系统（Database System）**：是由数据库，数据库管理系统，应用系统和数据库管理人员组成的存储、管理、处理和维护数据的系统。

**数据库系统的特点：**数据结构化，数据共享性高、冗余度低、易扩充，数据独立性高，数据由DBMS统一管理和控制。

**关于码的概念**：

- **候选码**：若关系中的某一属性组的值能唯一地标识一个元组， 则称该属性组为候选码  
- **全码**：关系模式的所有属性组是这个关系模式的候选码， 称为全码  
- **主码**：若一个关系有多个候选码， 则选定其中一个为主码  
- **外码**：设F是基本关系R的一个或一组属性， F不是关系R的码，但F是另一个关系的码， 则称F是基本关系R的外码  
- 候选码的每个属性都是主属性，不包含在任何侯选码中的属性称为非主属性或非码属性

**基本关系的性质**：

1. 列是同质的，即每一列中的分量是同类型数据，来自同一个域
2. 不同的列可能来自同一个域
3. 列的顺序无所谓，列的次序可以任意交换
4. 行的顺序无所谓，行的次序可以任意交换
5. 任意连个元组的候选码不能相同
6. 分量必须是原子值

**关系的完整性**：

- 实体完整性：若属性A是关系R的主属性，则A不能取空值
- 参照完整性：若属性（或属性组）F是基本关系R的外码，它与基本关系S的主码Ks相对应（基本关系R和S不一定是不同的关系），则对于R中每个元组在F上的值必须为空值或者等于S中某个元组的主码值    
- 用户定义完整性：针对某一具体关系数据库的约束条件， 反映某一具体应用所涉及的数据必须满足的语义要求  

#### 数据模型

常用数据模型：非关系模型（包括层次模型、网状模型），关系模型，面向对象模型，对象关系模型。

**层次模型**

层次模型需要满足以下两个基本条件：

1. 有且只有一个节点没有双亲节点，这个节点称为根节点。
2. 根以外的节点有且只有一个双亲节点。

**网状模型**

网状模型需要满足以下两个基本条件：

1. 允许一个以上的节点无双亲
2. 一个节点可以有多于一个的双亲

**关系模型**

相关概念：

> 关系：一个关系对应一张表
>
> 元组：表中的一行即为一个元组
>
> 属性：表中的一列即为一个属性
>
> 主码：表中的一个属性组，可以唯一确定一个元组
>
> 域：属性的取值范围
>
> 分量：元组中的一个属性值

关系的完整性约束条件：实体完整性，参照完整性，用户定义的完整性

### 2.关系数据理论

<div>
    <table style="text-align: center;width:450px">
        <tr>
            <th>column1</th>
            <th>column2</th>
            <th>column3</th>
        </tr>
        <tr>
            <td>value1</td>
            <td>value2</td>
            <td>value3</td>
        </tr>
    </table>
</div>

#### 数据依赖

1. **函数依赖**

    记 A->B 表示 A 函数决定 B，也可以说 B 函数依赖于 A。

    如果 {A1，A2，... ，An} 是关系的一个或多个属性的集合，该集合函数决定了关系的其它所有属性并且是最小的，那么该集合就称为键码。

    对于 A->B，如果能找到 A 的真子集 A'，使得 A'-> B，那么 A->B 就是**部分函数依赖**，否则就是完全函数依赖。

    对于 A->B，B->C，则 A->C 是一个**传递函数依赖**。

2. **多值依赖**：

**数据依赖带来的问题**：

- 数据冗余
- 修改异常
- 更新异常
- 删除异常

#### 范式

##### 1NF

如果关系模式R的**所有属性都是不可分的基本数据项**，则R∈ 1NF  

##### 2NF

若R∈ 1NF， 且**每一个非主属性完全函数依赖于码**， 则R∈ 2NF 

可以采用投影分解法将一个1NF的关系分解为多个2NF的关系，从一定程度上减轻1NF关系中存在的问题，但不能完全消除这些问题。

##### 3NF

若R∈ 2NF，且**每一个非主属性不传递依赖于码**(这使得非主属性之间不存在函数依赖)，则R∈ 3NF。

##### BCNF

若关系R的**每一个决定因素都包含码**，那么R∈ BCNF。

## SQL

### 数据定义

#### 模式的定义与删除

